SmartEnum from https://github.com/FredBienvenu/SmartEnum with some small modifications/fixes
